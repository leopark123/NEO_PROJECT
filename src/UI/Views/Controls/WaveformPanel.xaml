<UserControl x:Class="Neo.UI.Views.Controls.WaveformPanel"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">
    <UserControl.Resources>
        <Style x:Key="CompactParamComboStyle" TargetType="ComboBox" BasedOn="{StaticResource ParamComboBoxStyle}">
            <Setter Property="MinHeight" Value="28"/>
            <Setter Property="FontSize" Value="{StaticResource FontSize.Caption}"/>
            <Setter Property="Padding" Value="6,4"/>
        </Style>
        <DropShadowEffect x:Key="WavePanelShadowStrong"
                          Color="{StaticResource Color.Shadow}"
                          BlurRadius="12"
                          ShadowDepth="3"
                          Opacity="0.34"/>
        <DropShadowEffect x:Key="WavePanelShadowSoft"
                          Color="{StaticResource Color.Shadow}"
                          BlurRadius="7"
                          ShadowDepth="2"
                          Opacity="0.22"/>
    </UserControl.Resources>

    <Grid x:Name="RootGrid"
          Background="{DynamicResource BackgroundDarkBrush}"
          UseLayoutRounding="True"
          SnapsToDevicePixels="True">
        <Grid.RowDefinitions>
            <RowDefinition Height="60*"/>
            <RowDefinition Height="40*"/>
        </Grid.RowDefinitions>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="*"/>
            <ColumnDefinition x:Name="ParameterColumn" Width="176"/>
        </Grid.ColumnDefinitions>

        <Border x:Name="AeegEegCompositePanel"
                Grid.Row="0"
                Grid.ColumnSpan="2"
                Background="{DynamicResource BackgroundDarkBrush}"
                BorderBrush="{DynamicResource DividerMajorBrush}"
                BorderThickness="{StaticResource Dim.BorderThicknessMajor}"
                CornerRadius="{StaticResource Dim.CornerRadiusAll}"
                Effect="{StaticResource WavePanelShadowStrong}">
            <Grid IsHitTestVisible="False">
                <Border Margin="1"
                        BorderBrush="{DynamicResource PanelHighlightBrush}"
                        BorderThickness="1"
                        CornerRadius="9"/>
                <Border Margin="1,1,1,0"
                        BorderBrush="{DynamicResource PanelShadowBrush}"
                        BorderThickness="0,0,1,1"
                        CornerRadius="9"/>
            </Grid>
        </Border>

        <Border Grid.Column="0"
                Grid.Row="0"
                Margin="0,0,8,0"
                Background="{DynamicResource BackgroundDarkBrush}"
                BorderBrush="{DynamicResource DividerMajorBrush}"
                BorderThickness="{StaticResource Dim.BorderThicknessMajor}"
                CornerRadius="{StaticResource Dim.CornerRadiusAll}"
                Effect="{StaticResource WavePanelShadowStrong}">
            <Grid x:Name="RenderHostContainer"
                  ClipToBounds="True">
                <Image x:Name="RenderImage"
                       Stretch="None"
                       HorizontalAlignment="Left"
                       VerticalAlignment="Top"
                       SnapsToDevicePixels="True"
                       RenderOptions.BitmapScalingMode="NearestNeighbor"/>

                <Border x:Name="LoadingOverlay"
                        Background="{DynamicResource BackgroundDarkBrush}"
                        Visibility="Collapsed">
                    <TextBlock Text="Initializing renderer..."
                               Foreground="{DynamicResource TextDarkMutedBrush}"
                               FontSize="{StaticResource FontSize.Body}"
                               HorizontalAlignment="Center"
                               VerticalAlignment="Center"/>
                </Border>

                <Border x:Name="ErrorOverlay"
                        Background="{DynamicResource BackgroundDarkBrush}"
                        Opacity="0.86"
                        Visibility="Collapsed">
                    <StackPanel HorizontalAlignment="Center"
                                VerticalAlignment="Center">
                        <TextBlock Text="Render device lost"
                                   Foreground="{DynamicResource ErrorBrush}"
                                   FontSize="{StaticResource FontSize.Body}"
                                   FontWeight="SemiBold"
                                   HorizontalAlignment="Center"/>
                        <TextBlock Text="Click to recover"
                                   Foreground="{DynamicResource TextDarkSecondaryBrush}"
                                   FontSize="{StaticResource FontSize.Caption}"
                                   HorizontalAlignment="Center"
                                   Margin="0,4,0,0"/>
                    </StackPanel>
                </Border>
            </Grid>
        </Border>

        <Border x:Name="ParameterColumnHost"
                Grid.Column="1"
                Grid.Row="0"
                Background="{DynamicResource BackgroundBrush}"
                BorderBrush="{DynamicResource DividerMajorBrush}"
                BorderThickness="{StaticResource Dim.BorderThicknessNormal}"
                CornerRadius="{StaticResource Dim.CornerRadiusAll}"
                Effect="{StaticResource WavePanelShadowStrong}">
            <Grid Margin="4,8,4,8">
                <Grid.RowDefinitions>
                    <RowDefinition Height="*"/>
                    <RowDefinition Height="8"/>
                    <RowDefinition Height="*"/>
                </Grid.RowDefinitions>

                <Border x:Name="Eeg1ParameterPanel"
                        Grid.Row="0"
                        Background="{DynamicResource BackgroundBrush}"
                        BorderBrush="{DynamicResource BorderDarkBrush}"
                        BorderThickness="1"
                        CornerRadius="6"
                        Padding="4"
                        Effect="{StaticResource WavePanelShadowSoft}">
                    <StackPanel VerticalAlignment="Stretch">
                        <TextBlock Text="EEG-1 / aEEG-1"
                                   Foreground="{DynamicResource TextDarkSecondaryBrush}"
                                   FontSize="{StaticResource FontSize.Caption}"
                                   FontWeight="SemiBold"/>

                        <TextBlock Text="导联"
                                   Foreground="{DynamicResource TextDarkSecondaryBrush}"
                                   FontSize="{StaticResource FontSize.Caption}"
                                   Margin="2,1,0,1"/>
                        <ComboBox Style="{StaticResource CompactParamComboStyle}"
                                  ItemContainerStyle="{StaticResource ParamComboBoxItemStyle}"
                                  ItemsSource="{Binding Waveform.SourceOptions}"
                                  SelectedItem="{Binding Waveform.Eeg1Source, Mode=TwoWay}">
                            <ComboBox.ItemTemplate>
                                <DataTemplate>
                                    <TextBlock Text="{Binding Label}" Foreground="{DynamicResource TextOnDarkBrush}"/>
                                </DataTemplate>
                            </ComboBox.ItemTemplate>
                        </ComboBox>

                        <TextBlock Text="增益"
                                   Foreground="{DynamicResource TextDarkSecondaryBrush}"
                                   FontSize="{StaticResource FontSize.Caption}"
                                   Margin="2,2,0,1"/>
                        <ComboBox Style="{StaticResource CompactParamComboStyle}"
                                  ItemContainerStyle="{StaticResource ParamComboBoxItemStyle}"
                                  ItemsSource="{Binding Waveform.GainOptions}"
                                  SelectedItem="{Binding Waveform.Eeg1Gain, Mode=TwoWay}">
                            <ComboBox.ItemTemplate>
                                <DataTemplate>
                                    <TextBlock Text="{Binding StringFormat={}{0} uV/cm}" Foreground="{DynamicResource TextOnDarkBrush}"/>
                                </DataTemplate>
                            </ComboBox.ItemTemplate>
                        </ComboBox>

                        <TextBlock Text="范围"
                                   Foreground="{DynamicResource TextDarkSecondaryBrush}"
                                   FontSize="{StaticResource FontSize.Caption}"
                                   Margin="2,2,0,1"/>
                        <ComboBox Style="{StaticResource CompactParamComboStyle}"
                                  ItemContainerStyle="{StaticResource ParamComboBoxItemStyle}"
                                  ItemsSource="{Binding Waveform.YAxisOptions}"
                                  SelectedItem="{Binding Waveform.Eeg1Range, Mode=TwoWay}">
                            <ComboBox.ItemTemplate>
                                <DataTemplate>
                                    <TextBlock Text="{Binding StringFormat={}+/-{0} uV}" Foreground="{DynamicResource TextOnDarkBrush}"/>
                                </DataTemplate>
                            </ComboBox.ItemTemplate>
                        </ComboBox>
                    </StackPanel>
                </Border>

                <Border x:Name="Eeg2ParameterPanel"
                        Grid.Row="2"
                        Background="{DynamicResource BackgroundBrush}"
                        BorderBrush="{DynamicResource BorderDarkBrush}"
                        BorderThickness="1"
                        CornerRadius="6"
                        Padding="4"
                        Effect="{StaticResource WavePanelShadowSoft}">
                    <StackPanel VerticalAlignment="Stretch">
                        <TextBlock Text="EEG-2 / aEEG-2"
                                   Foreground="{DynamicResource TextDarkSecondaryBrush}"
                                   FontSize="{StaticResource FontSize.Caption}"
                                   FontWeight="SemiBold"/>

                        <TextBlock Text="导联"
                                   Foreground="{DynamicResource TextDarkSecondaryBrush}"
                                   FontSize="{StaticResource FontSize.Caption}"
                                   Margin="2,1,0,1"/>
                        <ComboBox Style="{StaticResource CompactParamComboStyle}"
                                  ItemContainerStyle="{StaticResource ParamComboBoxItemStyle}"
                                  ItemsSource="{Binding Waveform.SourceOptions}"
                                  SelectedItem="{Binding Waveform.Eeg2Source, Mode=TwoWay}">
                            <ComboBox.ItemTemplate>
                                <DataTemplate>
                                    <TextBlock Text="{Binding Label}" Foreground="{DynamicResource TextOnDarkBrush}"/>
                                </DataTemplate>
                            </ComboBox.ItemTemplate>
                        </ComboBox>

                        <TextBlock Text="增益"
                                   Foreground="{DynamicResource TextDarkSecondaryBrush}"
                                   FontSize="{StaticResource FontSize.Caption}"
                                   Margin="2,2,0,1"/>
                        <ComboBox Style="{StaticResource CompactParamComboStyle}"
                                  ItemContainerStyle="{StaticResource ParamComboBoxItemStyle}"
                                  ItemsSource="{Binding Waveform.GainOptions}"
                                  SelectedItem="{Binding Waveform.Eeg2Gain, Mode=TwoWay}">
                            <ComboBox.ItemTemplate>
                                <DataTemplate>
                                    <TextBlock Text="{Binding StringFormat={}{0} uV/cm}" Foreground="{DynamicResource TextOnDarkBrush}"/>
                                </DataTemplate>
                            </ComboBox.ItemTemplate>
                        </ComboBox>

                        <TextBlock Text="范围"
                                   Foreground="{DynamicResource TextDarkSecondaryBrush}"
                                   FontSize="{StaticResource FontSize.Caption}"
                                   Margin="2,2,0,1"/>
                        <ComboBox Style="{StaticResource CompactParamComboStyle}"
                                  ItemContainerStyle="{StaticResource ParamComboBoxItemStyle}"
                                  ItemsSource="{Binding Waveform.YAxisOptions}"
                                  SelectedItem="{Binding Waveform.Eeg2Range, Mode=TwoWay}">
                            <ComboBox.ItemTemplate>
                                <DataTemplate>
                                    <TextBlock Text="{Binding StringFormat={}+/-{0} uV}" Foreground="{DynamicResource TextOnDarkBrush}"/>
                                </DataTemplate>
                            </ComboBox.ItemTemplate>
                        </ComboBox>
                    </StackPanel>
                </Border>

            </Grid>
        </Border>

        <Border x:Name="NirsCompositePanel"
                Grid.Row="1"
                Grid.ColumnSpan="2"
                Background="{DynamicResource BackgroundDarkBrush}"
                BorderBrush="{DynamicResource DividerMajorBrush}"
                BorderThickness="{StaticResource Dim.BorderThicknessMajor}"
                CornerRadius="{StaticResource Dim.CornerRadiusAll}"
                Effect="{StaticResource WavePanelShadowStrong}">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="176"/>
                </Grid.ColumnDefinitions>

                <Border Grid.Column="0"
                        Margin="0,0,8,0"
                        Background="{DynamicResource BackgroundBrush}"
                        BorderBrush="{DynamicResource DividerNormalBrush}"
                        BorderThickness="{StaticResource Dim.BorderThicknessNormal}"
                        CornerRadius="{StaticResource Dim.CornerRadiusAll}"
                        Effect="{StaticResource WavePanelShadowSoft}">
                    <Grid Margin="8">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="*"/>
                        </Grid.RowDefinitions>

                        <TextBlock Text="NIRS 趋势"
                                   Foreground="{DynamicResource TextOnDarkBrush}"
                                   FontSize="{StaticResource FontSize.Caption}"
                                   FontWeight="SemiBold"/>

                        <Grid Grid.Row="1"
                              Margin="0,8,0,0">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="*"/>
                                <RowDefinition Height="*"/>
                                <RowDefinition Height="*"/>
                                <RowDefinition Height="*"/>
                            </Grid.RowDefinitions>

                            <Border Grid.Row="0"
                                    Margin="0,0,0,4"
                                    Background="{DynamicResource BackgroundDarkBrush}"
                                    BorderBrush="{DynamicResource DividerMinorBrush}"
                                    BorderThickness="{StaticResource Dim.BorderThicknessThin}"
                                    CornerRadius="4">
                                <Grid Margin="6,2">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="42"/>
                                        <ColumnDefinition Width="*"/>
                                    </Grid.ColumnDefinitions>
                                    <TextBlock Text="CH1"
                                               VerticalAlignment="Center"
                                               Foreground="{DynamicResource TextOnDarkBrush}"
                                               Opacity="0.78"
                                               FontSize="{StaticResource FontSize.Small}"/>
                                    <Viewbox Grid.Column="1" Stretch="Fill">
                                        <Canvas Width="200" Height="20">
                                            <Line X1="0" Y1="10" X2="200" Y2="10" Stroke="{DynamicResource DividerMinorBrush}" Opacity="0.56" StrokeThickness="0.8" StrokeDashArray="2 2"/>
                                            <Polygon x:Name="NirsTrendAreaCh1"
                                                     Points="0,10 10,8 22,11 36,7 52,12 66,8 82,11 96,7 112,10 130,9 146,12 162,8 178,11 192,9 200,10 200,18 0,18"
                                                     Fill="{DynamicResource NirsTrendBrush}"
                                                     Opacity="0.50"/>
                                        </Canvas>
                                    </Viewbox>
                                </Grid>
                            </Border>
                            <Border Grid.Row="1"
                                    Margin="0,0,0,4"
                                    Background="{DynamicResource BackgroundDarkBrush}"
                                    BorderBrush="{DynamicResource DividerMinorBrush}"
                                    BorderThickness="{StaticResource Dim.BorderThicknessThin}"
                                    CornerRadius="4">
                                <Grid Margin="6,2">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="42"/>
                                        <ColumnDefinition Width="*"/>
                                    </Grid.ColumnDefinitions>
                                    <TextBlock Text="CH2"
                                               VerticalAlignment="Center"
                                               Foreground="{DynamicResource TextOnDarkBrush}"
                                               Opacity="0.78"
                                               FontSize="{StaticResource FontSize.Small}"/>
                                    <Viewbox Grid.Column="1" Stretch="Fill">
                                        <Canvas Width="200" Height="20">
                                            <Line X1="0" Y1="10" X2="200" Y2="10" Stroke="{DynamicResource DividerMinorBrush}" Opacity="0.56" StrokeThickness="0.8" StrokeDashArray="2 2"/>
                                            <Polygon x:Name="NirsTrendAreaCh2"
                                                     Points="0,10 12,12 26,9 40,13 58,8 72,11 88,7 104,10 120,12 136,8 154,11 170,7 186,10 200,9 200,18 0,18"
                                                     Fill="{DynamicResource NirsTrendBrush}"
                                                     Opacity="0.50"/>
                                        </Canvas>
                                    </Viewbox>
                                </Grid>
                            </Border>
                            <Border Grid.Row="2"
                                    Margin="0,0,0,4"
                                    Background="{DynamicResource BackgroundDarkBrush}"
                                    BorderBrush="{DynamicResource DividerMinorBrush}"
                                    BorderThickness="{StaticResource Dim.BorderThicknessThin}"
                                    CornerRadius="4">
                                <Grid Margin="6,2">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="42"/>
                                        <ColumnDefinition Width="*"/>
                                    </Grid.ColumnDefinitions>
                                    <TextBlock Text="CH3"
                                               VerticalAlignment="Center"
                                               Foreground="{DynamicResource TextOnDarkBrush}"
                                               Opacity="0.78"
                                               FontSize="{StaticResource FontSize.Small}"/>
                                    <Viewbox Grid.Column="1" Stretch="Fill">
                                        <Canvas Width="200" Height="20">
                                            <Line X1="0" Y1="10" X2="200" Y2="10" Stroke="{DynamicResource DividerMinorBrush}" Opacity="0.56" StrokeThickness="0.8" StrokeDashArray="2 2"/>
                                            <Polygon x:Name="NirsTrendAreaCh3"
                                                     Points="0,10 14,7 28,11 46,8 62,12 78,9 94,13 110,8 126,10 142,7 158,11 176,8 192,10 200,9 200,18 0,18"
                                                     Fill="{DynamicResource NirsTrendBrush}"
                                                     Opacity="0.50"/>
                                        </Canvas>
                                    </Viewbox>
                                </Grid>
                            </Border>
                            <Border Grid.Row="3"
                                    Background="{DynamicResource BackgroundDarkBrush}"
                                    BorderBrush="{DynamicResource DividerMinorBrush}"
                                    BorderThickness="{StaticResource Dim.BorderThicknessThin}"
                                    CornerRadius="4">
                                <Grid Margin="6,2">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="42"/>
                                        <ColumnDefinition Width="*"/>
                                    </Grid.ColumnDefinitions>
                                    <TextBlock Text="CH4"
                                               VerticalAlignment="Center"
                                               Foreground="{DynamicResource TextOnDarkBrush}"
                                               Opacity="0.78"
                                               FontSize="{StaticResource FontSize.Small}"/>
                                    <Viewbox Grid.Column="1" Stretch="Fill">
                                        <Canvas Width="200" Height="20">
                                            <Line X1="0" Y1="10" X2="200" Y2="10" Stroke="{DynamicResource DividerMinorBrush}" Opacity="0.56" StrokeThickness="0.8" StrokeDashArray="2 2"/>
                                            <Polygon x:Name="NirsTrendAreaCh4"
                                                     Points="0,10 10,9 24,12 38,8 54,10 70,7 86,11 104,8 120,12 138,9 154,11 170,8 186,10 200,9 200,18 0,18"
                                                     Fill="{DynamicResource NirsTrendBrush}"
                                                     Opacity="0.50"/>
                                        </Canvas>
                                    </Viewbox>
                                </Grid>
                            </Border>
                        </Grid>
                    </Grid>
                </Border>

                <Border Grid.Column="1"
                        Background="{DynamicResource BackgroundBrush}"
                        BorderBrush="{DynamicResource DividerNormalBrush}"
                        BorderThickness="{StaticResource Dim.BorderThicknessNormal}"
                        CornerRadius="{StaticResource Dim.CornerRadiusAll}"
                        Effect="{StaticResource WavePanelShadowSoft}">
                    <Grid Margin="8">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="*"/>
                        </Grid.RowDefinitions>

                        <TextBlock Text="组织氧饱和度"
                                   Foreground="{DynamicResource TextOnDarkBrush}"
                                   FontSize="{StaticResource FontSize.Caption}"
                                   FontWeight="SemiBold"/>

                        <Grid Grid.Row="1"
                              Margin="0,8,0,0">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="*"/>
                                <RowDefinition Height="*"/>
                                <RowDefinition Height="*"/>
                                <RowDefinition Height="*"/>
                            </Grid.RowDefinitions>

                            <Border Grid.Row="0"
                                    Margin="0,0,0,4"
                                    Background="{DynamicResource BackgroundDarkBrush}"
                                    BorderBrush="{DynamicResource NirsTrendBrush}"
                                    BorderThickness="{StaticResource Dim.BorderThicknessThin}"
                                    CornerRadius="4">
                                <TextBlock x:Name="NirsSaturationCh1"
                                           Text="CH1  --%"
                                           Margin="8,0"
                                           VerticalAlignment="Center"
                                           Foreground="{DynamicResource TextOnDarkBrush}"
                                           FontSize="{StaticResource FontSize.Small}"/>
                            </Border>
                            <Border Grid.Row="1"
                                    Margin="0,0,0,4"
                                    Background="{DynamicResource BackgroundDarkBrush}"
                                    BorderBrush="{DynamicResource NirsTrendBrush}"
                                    BorderThickness="{StaticResource Dim.BorderThicknessThin}"
                                    CornerRadius="4">
                                <TextBlock x:Name="NirsSaturationCh2"
                                           Text="CH2  --%"
                                           Margin="8,0"
                                           VerticalAlignment="Center"
                                           Foreground="{DynamicResource TextOnDarkBrush}"
                                           FontSize="{StaticResource FontSize.Small}"/>
                            </Border>
                            <Border Grid.Row="2"
                                    Margin="0,0,0,4"
                                    Background="{DynamicResource BackgroundDarkBrush}"
                                    BorderBrush="{DynamicResource NirsTrendBrush}"
                                    BorderThickness="{StaticResource Dim.BorderThicknessThin}"
                                    CornerRadius="4">
                                <TextBlock x:Name="NirsSaturationCh3"
                                           Text="CH3  --%"
                                           Margin="8,0"
                                           VerticalAlignment="Center"
                                           Foreground="{DynamicResource TextOnDarkBrush}"
                                           FontSize="{StaticResource FontSize.Small}"/>
                            </Border>
                            <Border Grid.Row="3"
                                    Background="{DynamicResource BackgroundDarkBrush}"
                                    BorderBrush="{DynamicResource NirsTrendBrush}"
                                    BorderThickness="{StaticResource Dim.BorderThicknessThin}"
                                    CornerRadius="4">
                                <TextBlock x:Name="NirsSaturationCh4"
                                           Text="CH4  --%"
                                           Margin="8,0"
                                           VerticalAlignment="Center"
                                           Foreground="{DynamicResource TextOnDarkBrush}"
                                           FontSize="{StaticResource FontSize.Small}"/>
                            </Border>
                        </Grid>
                    </Grid>
                </Border>

                <Border Grid.ColumnSpan="2"
                        Margin="1"
                        BorderBrush="{DynamicResource PanelHighlightBrush}"
                        BorderThickness="1"
                        CornerRadius="9"
                        IsHitTestVisible="False"/>
                <Border Grid.ColumnSpan="2"
                        Margin="1,1,1,0"
                        BorderBrush="{DynamicResource PanelShadowBrush}"
                        BorderThickness="0,0,1,1"
                        CornerRadius="9"
                        IsHitTestVisible="False"/>
            </Grid>
        </Border>
    </Grid>

</UserControl>

