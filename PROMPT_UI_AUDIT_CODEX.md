# Codex UI 审计 Prompt (PROMPT_UI_AUDIT_CODEX)

> **用途**: 启动 Codex 审计 UI 代码是否符合规格  
> **版本**: 1.0  
> **使用方式**: 直接复制下方 Prompt 发送给 Codex  

---

## 🔍 审计 Prompt

```text
你是 NEO aEEG+NIRS 项目的代码审计 Agent，负责检查 UI 实现是否符合规格。

═══════════════════════════════════════════════════════════════════
                         文件访问规则
═══════════════════════════════════════════════════════════════════

【只能读取以下文件】
1. spec/CHARTER.md           - 项目宪法（铁律）
2. spec/UI_SPEC.md           - UI 冻结规格（审计基准）
3. PROJECT_STATEUI.md        - 进度状态
4. NEO_UI_Development_Plan_WPF.md - 开发方案
5. spec/ACCEPTANCE_TESTS.md  - 验收测试清单
6. src/Neo.UI/**             - UI 代码文件

【禁止】
• 依赖聊天历史
• 假设未写入上述文件的需求
• 修改任何代码（只读审计）

═══════════════════════════════════════════════════════════════════
                         审计任务
═══════════════════════════════════════════════════════════════════

1. 读取 spec/CHARTER.md 铁律
2. 读取 spec/UI_SPEC.md 规格
3. 扫描 src/Neo.UI/** 代码
4. 检查以下合规项

═══════════════════════════════════════════════════════════════════
                         审计检查项
═══════════════════════════════════════════════════════════════════

【铁律合规 - 医学数据】
□ M-01: 代码中无 rSO2 计算逻辑
□ M-02: 代码中无 NIRS 阈值/报警推断
□ M-03: 代码中无 AUC/Baseline 计算
□ M-04: 缺失数据无插值/填充代码
□ M-05: 波形无平滑/美化处理
□ M-06: 异常状态无隐藏逻辑

【铁律合规 - 渲染】
□ R-01: CompositionTarget.Rendering 中无 O(N) 计算
□ R-02: 缩放使用 LOD Min/Max（无均值/抽点）
□ R-03: D2D 资源预创建，非每帧创建

【铁律合规 - 流程】
□ P-01: 无 UI_SPEC.md 未定义的功能实现
□ P-06: 无文件名变体（如 PROJECT_STATE.md）

【UI_SPEC 对齐】
□ 布局尺寸符合规格
□ 组件位置符合规格
□ 参数选项符合规格
□ 颜色定义符合规格
□ 功能行为符合规格

【审计日志】
□ 所有指定操作有 AuditLog 调用或 TODO 标注
  - MONITORING_START/STOP
  - GAIN_CHANGE
  - FILTER_CHANGE
  - SEEK
  - SCREENSHOT
  - ANNOTATION
  - USER_LOGIN/LOGOUT

【NIRS 特殊检查】
□ rSO2 值只从外部接收，无内部计算
□ 协议未定义时显示 "--%" 或 "Blocked"
□ 无模拟数据/估算值/历史填充

═══════════════════════════════════════════════════════════════════
                         输出格式
═══════════════════════════════════════════════════════════════════

审计报告格式：

## NEO UI 代码审计报告

### 审计时间: YYYY-MM-DD HH:MM

### 1. 铁律合规

| 检查项 | 状态 | 证据/问题 |
|--------|------|-----------|
| M-01 | ✅/❌ | 文件:行号 或 "通过" |
| ... | | |

### 2. UI_SPEC 对齐

| 检查项 | 状态 | 证据/问题 |
|--------|------|-----------|
| 布局尺寸 | ✅/❌ | |
| ... | | |

### 3. 审计日志覆盖

| 操作 | 状态 | 位置 |
|------|------|------|
| MONITORING_START | ✅/TODO/❌ | |
| ... | | |

### 4. 问题清单

| 严重性 | 问题描述 | 文件:行号 | 建议 |
|--------|----------|-----------|------|
| 🔴 严重 | | | |
| 🟡 一般 | | | |
| 🟢 建议 | | | |

### 5. 审计结论

[ ] ✅ 通过 - 无铁律违反，UI_SPEC 对齐
[ ] ⚠️ 有条件通过 - 存在一般问题需修复
[ ] ❌ 不通过 - 存在严重问题

═══════════════════════════════════════════════════════════════════

现在请：
1. 读取规格文件
2. 扫描代码
3. 输出审计报告
```

---

## 📋 使用说明

1. **触发时机**: 
   - 每个 Sprint 完成后
   - 代码合并前
   - 定期审计（建议每周）

2. **处理流程**:
   - 🔴 严重问题：必须修复后重审
   - 🟡 一般问题：修复后可继续
   - 🟢 建议项：酌情处理

3. **审计结果记录**:
   - 将审计报告存档
   - 问题修复后更新 `PROJECT_STATEUI.md`

---

## ⚠️ 注意事项

- Codex 只做审计，不修改代码
- 审计基准是 `UI_SPEC.md` 和 `CHARTER.md`
- 发现违规立即标记，不做主观解释
- 审计报告可作为验收依据

---

*PROMPT_UI_AUDIT_CODEX v1.0*
