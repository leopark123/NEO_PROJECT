# S3-00 NIRS RS232 协议证据清单（设备方填写）

> **用途**: 解冻 S3-00 NIRS RS232 Protocol Spec & Parser 所需的最小证据集
> **阻塞裁决**: ADR-015（2026-01-28）
> **状态**: 🔴 待设备方提供
> **接收方**: NEO 软件开发团队
> **提供方**: _______________（设备方名称 / 联系人）

---

## 背景

NEO 系统的 NIRS 模块（S3-00）因缺少 RS232 协议证据被裁决为 **Blocked**（ADR-015）。
EEG 协议已有完整 ICD（见 `evidence/sources/icd/ICD_EEG_RS232_Protocol_Fields.md`），
NIRS 协议需要提供与 EEG ICD 同等精度的技术文档才能解冻实现。

**解冻条件**: 以下 §1-§6 所有必填项均以可引用文本（.docx / .pdf / .md）形式提供。

---

## §1 数据包格式 🔴 **[必填]**

请提供 NIRS 数据包的完整字节级布局。

| 填写项 | 值（设备方填写） | 示例（参考 EEG） |
|--------|-----------------|------------------|
| 帧头字节 | _______________ | `0xAA 0x55` |
| 帧头长度 | _____ bytes | 2 bytes |
| 数据区长度 | _____ bytes | 36 bytes |
| 校验区长度 | _____ bytes | 2 bytes |
| **总帧长度** | **_____ bytes** | **40 bytes** |

如有可变长帧，请说明长度字段位置及编码方式：

```
（在此处填写帧结构示意图，例如：）
[Header: 2B] [Length: 1B] [Data: NB] [CRC: 2B]

或固定长度：
[Header: ?B] [Data: ?B] [CRC: ?B]
```

---

## §2 字节序 🔴 **[必填]**

| 填写项 | 值（设备方填写） | 示例 |
|--------|-----------------|------|
| 多字节整数字节序 | _______________（大端序 / 小端序） | 大端序 (Big-Endian) |
| 适用范围 | _______________（仅数据区 / 含帧头 / 全帧） | 数据区 + CRC |

---

## §3 校验算法 🔴 **[必填]**

| 填写项 | 值（设备方填写） | 示例 |
|--------|-----------------|------|
| 算法类型 | _______________（CRC-16 / 累加和 / CRC-CCITT / 异或校验 / 其他） | 累加和 |
| 校验范围 | _______________（从第 ? 字节到第 ? 字节） | Header + Data (byte 0-37) |
| 初始值 | _______________ | 0x0000 |
| 多项式（如 CRC） | _______________ | N/A（累加和） |
| 结果字节序 | _______________（大端序 / 小端序） | 大端序 |

如有参考实现代码，请一并提供（语言不限：C/C++/Python/伪代码）。

---

## §4 数据字段映射 🔴 **[必填]**

请列出数据区每个字段的含义。格式参照 EEG ICD §2。

| 偏移 (byte) | 长度 (bytes) | 数据类型 | 字段名 | 物理含义 | 单位 | 值范围 |
|-------------|-------------|----------|--------|----------|------|--------|
| ? | ? | ___ | Ch1 | _______________ | ___ | ___ |
| ? | ? | ___ | Ch2 | _______________ | ___ | ___ |
| ? | ? | ___ | Ch3 | _______________ | ___ | ___ |
| ? | ? | ___ | Ch4 | _______________ | ___ | ___ |
| ? | ? | ___ | Ch5 | _______________ | ___ | ___ |
| ? | ? | ___ | Ch6 | _______________ | ___ | ___ |
| ? | ? | ___ | 状态字 | _______________ | ___ | ___ |
| ... | ... | ... | ... | ... | ... | ... |

**已知约束**（来自 CONSENSUS_BASELINE.md §12.3）：
- 通道数: 6
- 数据类型: SpO₂ 百分比
- 值范围: 0-100%
- 采样率: 1-4 Hz

### 4.1 数值转换

| 填写项 | 值（设备方填写） | 示例 |
|--------|-----------------|------|
| 原始值类型 | _______________（int16 / uint16 / uint8 / float32） | int16 |
| 转换公式 | _______________（例：SpO₂% = raw × scale + offset） | μV = raw × 0.076 |
| 比例系数 | _______________ | 0.076 |
| 偏移量 | _______________ | 0 |
| 无效值标记 | _______________（例：0xFFFF 表示无信号） | — |

### 4.2 状态/标志位（如有）

| Bit | 含义 | 值=0 | 值=1 |
|-----|------|------|------|
| bit 0 | _______________ | ___ | ___ |
| bit 1 | _______________ | ___ | ___ |
| ... | ... | ... | ... |

---

## §5 串口参数 🔴 **[必填]**

| 填写项 | 值（设备方填写） | 示例 |
|--------|-----------------|------|
| 波特率 | _____ bps | 115200 bps |
| 数据位 | _____ | 8 |
| 停止位 | _____ | 1 |
| 校验位 | _______________（None / Even / Odd） | None |
| 流控 | _______________（None / RTS-CTS / XON-XOFF） | None |

---

## §6 通道配置 🔴 **[必填]**

| 通道 | 探头位置/名称 | 物理含义 | 波长 (nm) | 备注 |
|------|-------------|----------|-----------|------|
| Ch1 | _______________ | _______________ | ___ | ___ |
| Ch2 | _______________ | _______________ | ___ | ___ |
| Ch3 | _______________ | _______________ | ___ | ___ |
| Ch4 | _______________ | _______________ | ___ | ___ |
| Ch5 | _______________ | _______________ | ___ | ___ |
| Ch6 | _______________ | _______________ | ___ | ___ |

### 6.1 是否有计算通道？

| 计算通道 | 公式 | 来源通道 |
|----------|------|----------|
| ___ | _______________（例：Ch_X = Ch_A - Ch_B） | ___ |

---

## §7 时序 🟡 **[可选但建议提供]**

| 填写项 | 值（设备方填写） | 示例 |
|--------|-----------------|------|
| 数据发送频率 | _____ Hz | 4 Hz |
| 帧间间隔 | _____ ms | 250 ms |
| 上电到首帧延迟 | _____ ms | — |
| 是否支持请求/应答模式 | _______________（是 / 否，仅连续流） | 仅连续流 |

---

## §8 参考材料 🟡 **[可选但强烈建议]**

请提供以下任一或全部：

- [ ] 协议规格书 (.pdf / .docx)
- [ ] 参考解析代码 (C/C++/Python，任何语言均可)
- [ ] 串口抓包数据 (至少 100 帧，含已知 SpO₂ 值的标注)
- [ ] 设备用户手册中通信协议章节

---

## 验收标准

设备方提供的证据必须满足：

| # | 标准 | 说明 |
|---|------|------|
| 1 | **可引用** | 文本格式（.docx / .pdf / .md），非口头说明 |
| 2 | **字节级精度** | 精确到每个字节的偏移、长度、类型 |
| 3 | **可独立验证** | 提供的信息足以让开发者**不接触设备**即可编写解析器 |
| 4 | **含校验算法** | 必须能独立计算并验证 CRC/Checksum |
| 5 | **覆盖全部 6 通道** | 每个通道的物理含义、单位、值范围 |

---

## 流程

```
1. 设备方填写本文档 §1-§6（必填）+ §7-§8（建议）
2. 设备方交付填写后的文档 → evidence/sources/icd/ICD_NIRS_RS232_Protocol_Fields.md
3. NEO 团队审核：
   - 是否满足 5 项验收标准？
   - 能否独立编写解析器？
4. 审核通过 → S3-00 解冻 → 进入实现阶段
5. 审核不通过 → 标注缺失项 → 返回设备方补充
```

---

## 对照参考

完整的 EEG RS232 协议 ICD 示例见：

```
evidence/sources/icd/ICD_EEG_RS232_Protocol_Fields.md
```

NIRS 协议文档应达到与 EEG ICD 同等的完整度和精度。

---

**文档结束**

> 填写日期: _______________
> 填写人: _______________
> 联系方式: _______________
